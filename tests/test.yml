- hosts: etcd_nodes,single_etcd_node
  become: yes
  pre_tasks:
  - name: Ensure cert dir exists
    file:
      path: /etc/etcd
      state: directory
  - name: Copy certs
    copy:
      src: node-certs/{{ inventory_hostname }}/
      dest: /etc/etcd/
  - include_role:
      name: jumperfly.kubelet
    when: etcd_install_mode == 'pod'
- hosts: etcd_nodes
  become: yes
  roles:
  - role: etcd_node
- hosts: single_etcd_node
  become: yes
  roles:
  - role: etcd_node
    etcd_ansible_group: single_etcd_node
